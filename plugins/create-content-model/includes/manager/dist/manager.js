(()=>{"use strict";var e={20:(e,t,l)=>{var n=l(609),a=Symbol.for("react.element"),r=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};t.jsx=function(e,t,l){var n,c={},s=null,u=null;for(n in void 0!==l&&(s=""+l),void 0!==t.key&&(s=""+t.key),void 0!==t.ref&&(u=t.ref),t)r.call(t,n)&&!i.hasOwnProperty(n)&&(c[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===c[n]&&(c[n]=t[n]);return{$$typeof:a,type:e,key:s,ref:u,props:c,_owner:o.current}}},848:(e,t,l)=>{e.exports=l(20)},609:e=>{e.exports=window.React}},t={};function l(n){var a=t[n];if(void 0!==a)return a.exports;var r=t[n]={exports:{}};return e[n](r,r.exports,l),r.exports}var n=l(609);const a=window.wp.hooks,r=window.wp.element,o=window.wp.compose,i=window.wp.data,c=window.wp.blockEditor,s={"core/group":["content"],"core/paragraph":["content"],"core/heading":["content"],"core/image":["id","url","title","alt"],"core/button":["url","text","linkTarget","rel"]},{BINDINGS_KEY:u,BLOCK_VARIATION_NAME_ATTR:m,POST_TYPE_NAME:d}=window.contentModelData,p=window.wp.i18n,g=window.wp.components,_=window.wp.coreData,h=window.wp.url,E=({defaultFormData:e={label:"",slug:"",description:"",type:"text",visible:!1,uuid:crypto.randomUUID()},onSave:t=()=>{}})=>{const[l,a]=(0,r.useState)(e),[o,i]=(0,r.useState)(!1),[c,s]=(0,_.useEntityProp)("postType",d,"meta"),u=c?.blocks?JSON.parse(c.blocks):[];return(0,r.useEffect)((()=>{""===l.label?i(!1):i(!0)}),[l]),(0,n.createElement)(n.Fragment,null,(0,n.createElement)("form",{onSubmit:e=>{e.preventDefault();let n=u;if(""===l.slug){const e=(0,h.cleanForSlug)(l.label).replace(/-/g,"_");l.slug=e}u.find((e=>e.uuid===l.uuid))?(n=n.map((e=>(e.uuid===l.uuid&&(e=l),e))),s({blocks:JSON.stringify(n)})):s({blocks:JSON.stringify([...n,l])}),t(l)}},(0,n.createElement)(g.TextControl,{label:(0,p.__)("Binding Name"),value:l.label,onChange:e=>a({...l,label:e})}),(0,n.createElement)(g.Button,{variant:"secondary",type:"submit",disabled:!o},(0,p.__)("Save Field"))))},v=({attributes:e,setAttributes:t,name:l})=>{var a,o,i;const h=s[l],v=e?.metadata?.[u],[w,b]=(0,r.useState)(null),[x,y]=(0,_.useEntityProp)("postType",d,"meta"),f=(0,r.useMemo)((()=>x?.blocks?JSON.parse(x.blocks):[]),[x.blocks]),k=f.find((t=>t.slug===e.metadata?.slug)),B=(0,r.useCallback)((()=>{var l;const n={metadata:{...null!==(l=e.metadata)&&void 0!==l?l:{}}};delete n.metadata[u],delete n.metadata[m],delete n.metadata.slug;const a=f.filter((t=>t.slug!==e.metadata.slug));y({blocks:JSON.stringify(a)}),t(n)}),[e.metadata,t,f,y]),S=(0,r.useCallback)((l=>{var n;const a=h.reduce(((e,t)=>(e[t]="post_content"===l.slug?l.slug:`${l.slug}__${t}`,e)),{}),r={metadata:{...null!==(n=e.metadata)&&void 0!==n?n:{},[m]:l.label,slug:l.slug,[u]:a}};t(r)}),[e.metadata,t,h]);return(0,n.createElement)(c.InspectorControls,null,(0,n.createElement)(g.PanelBody,{title:"Attribute Bindings",initialOpen:!0},!w&&v&&(0,n.createElement)(g.__experimentalItemGroup,{isBordered:!0,isSeparated:!0},h.map((e=>(0,n.createElement)(g.__experimentalItem,{key:e},(0,n.createElement)(g.Flex,null,(0,n.createElement)(g.FlexBlock,null,e),v[e]&&(0,n.createElement)(g.FlexItem,null,(0,n.createElement)("span",null,(0,n.createElement)("code",null,v[e])))))))),!w&&(0,n.createElement)(g.PanelRow,null,(0,n.createElement)(g.ButtonGroup,null,(0,n.createElement)(g.Button,{variant:"secondary",onClick:()=>b(m)},v?(0,p.__)("Manage Binding"):(0,p.__)("Add Binding")),v&&(0,n.createElement)(g.Button,{isDestructive:!0,onClick:B},(0,p.__)("Remove Binding")))),w&&(0,n.createElement)(g.PanelRow,null,(0,n.createElement)(E,{onSave:e=>{S(e),b(null)},defaultFormData:{label:null!==(a=e?.metadata?.[m])&&void 0!==a?a:"",slug:null!==(o=e?.metadata?.slug)&&void 0!==o?o:"",uuid:null!==(i=k?.uuid)&&void 0!==i?i:crypto.randomUUID(),description:"",type:l,visible:!1},typeIsDisabled:!0}))))},w=(0,o.createHigherOrderComponent)((e=>t=>{const{getBlockParentsByBlockName:l,getBlocksByClientId:a}=(0,i.useSelect)(c.store),o=l(t.clientId,["core/group"]),m=(0,r.useMemo)((()=>a(o).filter((e=>Object.keys(e?.attributes?.metadata?.[u]||{}).length>0)).length>0),[o,a]),d=s[t.name]&&!m;return(0,n.createElement)(n.Fragment,null,d&&(0,n.createElement)(v,{...t}),(0,n.createElement)(e,{...t}))}),"withAttributeBinder"),b=window.wp.plugins,x=window.wp.editor,y=window.wp.notices,f=window.wp.primitives;var k=l(848);const B=(0,k.jsx)(f.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,k.jsx)(f.Path,{d:"m7.3 9.7 1.4 1.4c.2-.2.3-.3.4-.5 0 0 0-.1.1-.1.3-.5.4-1.1.3-1.6L12 7 9 4 7.2 6.5c-.6-.1-1.1 0-1.6.3 0 0-.1 0-.1.1-.3.1-.4.2-.6.4l1.4 1.4L4 11v1h1l2.3-2.3zM4 20h9v-1.5H4V20zm0-5.5V16h16v-1.5H4z"})}),S=(0,k.jsx)(f.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,k.jsx)(f.Path,{d:"m9.99609 14v-.2251l.00391.0001v6.225h1.5v-14.5h2.5v14.5h1.5v-14.5h3v-1.5h-8.50391c-2.76142 0-5 2.23858-5 5 0 2.7614 2.23858 5 5 5z"})}),P=(0,k.jsx)(f.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,k.jsx)(f.Path,{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM5 4.5h14c.3 0 .5.2.5.5v8.4l-3-2.9c-.3-.3-.8-.3-1 0L11.9 14 9 12c-.3-.2-.6-.2-.8 0l-3.6 2.6V5c-.1-.3.1-.5.4-.5zm14 15H5c-.3 0-.5-.2-.5-.5v-2.4l4.1-3 3 1.9c.3.2.7.2.9-.1L16 12l3.5 3.4V19c0 .3-.2.5-.5.5z"})}),C=(0,k.jsx)(f.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,k.jsx)(f.Path,{d:"M6 5V18.5911L12 13.8473L18 18.5911V5H6Z"})}),F=(0,k.jsx)(f.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,k.jsx)(f.Path,{d:"M18 4h-7c-1.1 0-2 .9-2 2v3H6c-1.1 0-2 .9-2 2v7c0 1.1.9 2 2 2h7c1.1 0 2-.9 2-2v-3h3c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm-4.5 14c0 .3-.2.5-.5.5H6c-.3 0-.5-.2-.5-.5v-7c0-.3.2-.5.5-.5h3V13c0 1.1.9 2 2 2h2.5v3zm0-4.5H11c-.3 0-.5-.2-.5-.5v-2.5H13c.3 0 .5.2.5.5v2.5zm5-.5c0 .3-.2.5-.5.5h-3V11c0-1.1-.9-2-2-2h-2.5V6c0-.3.2-.5.5-.5h7c.3 0 .5.2.5.5v7z"})}),I=(0,k.jsx)(f.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,k.jsx)(f.Path,{d:"M8 12.5h8V11H8v1.5Z M19 6.5H5a2 2 0 0 0-2 2V15a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V8.5a2 2 0 0 0-2-2ZM5 8h14a.5.5 0 0 1 .5.5V15a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5V8.5A.5.5 0 0 1 5 8Z"})}),T=(0,k.jsx)(f.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,k.jsx)(f.Path,{d:"M19 8h-1V6h-5v2h-2V6H6v2H5c-1.1 0-2 .9-2 2v8c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-8c0-1.1-.9-2-2-2zm.5 10c0 .3-.2.5-.5.5H5c-.3 0-.5-.2-.5-.5v-8c0-.3.2-.5.5-.5h14c.3 0 .5.2.5.5v8z"})}),V=(0,k.jsx)(f.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,k.jsx)(f.Path,{d:"M6.5 12.4L12 8l5.5 4.4-.9 1.2L12 10l-4.5 3.6-1-1.2z"})}),M=(0,k.jsx)(f.SVG,{viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,k.jsx)(f.Path,{d:"M17.5 11.6L12 16l-5.5-4.4.9-1.2L12 14l4.5-3.6 1 1.2z"})}),D=(0,k.jsx)(f.SVG,{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",children:(0,k.jsx)(f.Path,{fillRule:"evenodd",clipRule:"evenodd",d:"M12 5.5A2.25 2.25 0 0 0 9.878 7h4.244A2.251 2.251 0 0 0 12 5.5ZM12 4a3.751 3.751 0 0 0-3.675 3H5v1.5h1.27l.818 8.997a2.75 2.75 0 0 0 2.739 2.501h4.347a2.75 2.75 0 0 0 2.738-2.5L17.73 8.5H19V7h-3.325A3.751 3.751 0 0 0 12 4Zm4.224 4.5H7.776l.806 8.861a1.25 1.25 0 0 0 1.245 1.137h4.347a1.25 1.25 0 0 0 1.245-1.137l.805-8.861Z"})}),O=({field:e={label:"",slug:"",description:"",type:"text",visible:!1},onChange:t=()=>{},onDelete:l=()=>{},onMoveUp:a=()=>{},onMoveDown:o=()=>{},index:i,total:c})=>{const[s,u]=(0,r.useState)(e),[m,d]=(0,r.useState)(""!==s.slug);return(0,r.useEffect)((()=>{m||u({...s,slug:(0,h.cleanForSlug)(s.label).replace(/-/g,"_")}),t(s)}),[s]),(0,n.createElement)(n.Fragment,null,(0,n.createElement)(g.Card,null,(0,n.createElement)(g.CardBody,null,(0,n.createElement)(g.ButtonGroup,{style:{marginBottom:"1rem"}},(0,n.createElement)(g.Button,{icon:B,title:s.type},(0,p.__)("Custom Field")),i>0&&(0,n.createElement)(g.Button,{icon:V,title:(0,p.__)("Move Field Up"),onClick:()=>{a(s)}}),i<c-1&&(0,n.createElement)(g.Button,{icon:M,title:(0,p.__)("Move Field Down"),onClick:()=>{o(s)}}),(0,n.createElement)(g.Button,{icon:D,title:(0,p.__)("Delete Field"),onClick:()=>{confirm((0,p.__)("Are you sure you want to delete this field?"))&&l(s)}})),(0,n.createElement)(g.__experimentalGrid,{columns:4},(0,n.createElement)(g.TextControl,{label:(0,p.__)("Name"),value:s.label,onChange:e=>u({...s,label:e})}),(0,n.createElement)(g.TextControl,{label:(0,p.__)("Key"),value:s.slug,onChange:e=>{d(!0),u({...s,slug:e})}}),(0,n.createElement)(g.TextControl,{label:(0,p.__)("Description (optional)"),value:s.description,onChange:e=>u({...s,description:e})}),(0,n.createElement)(g.SelectControl,{label:(0,p.__)("Field Type"),value:s.type,options:[{label:(0,p.__)("Text"),value:"text"},{label:(0,p.__)("Textarea"),value:"textarea"},{label:(0,p.__)("URL"),value:"url"},{label:(0,p.__)("Image"),value:"image"},{label:(0,p.__)("Number"),value:"number"}],onChange:e=>u({...s,type:e})})),(0,n.createElement)(g.__experimentalItemGroup,{isBordered:!0,isSeparated:!0},(0,n.createElement)(g.__experimentalItem,null,(0,n.createElement)(g.Flex,null,(0,n.createElement)(g.FlexBlock,null,s.type),(0,n.createElement)(g.FlexItem,null,(0,n.createElement)("span",null,(0,n.createElement)("code",null,s.slug)))))))))},N=({slug:e,type:t})=>{const l=s[t];return(0,n.createElement)(g.__experimentalItemGroup,{isBordered:!0,isSeparated:!0},l.map((t=>(0,n.createElement)(g.__experimentalItem,{key:t},(0,n.createElement)(g.Flex,null,(0,n.createElement)(g.FlexBlock,null,t),(0,n.createElement)(g.FlexItem,null,(0,n.createElement)("span",null,"post_content"===e?(0,n.createElement)("code",null,e):(0,n.createElement)("code",null,`${e}__${t}`))))))))},j=e=>{switch(e){case"core/paragraph":return S;case"core/image":return P;case"core/heading":return C;case"core/group":return F;case"core/button":return I;default:return T}},G=({block:e={label:"",slug:"",description:"",type:"text",visible:!1},onChange:t=()=>{}})=>{const[l,a]=(0,r.useState)(e);return(0,r.useEffect)((()=>{t(l)}),[l]),(0,n.createElement)(n.Fragment,null,(0,n.createElement)(g.Card,null,(0,n.createElement)(g.CardBody,null,(0,n.createElement)(g.ButtonGroup,{style:{marginBottom:"1rem"}},(0,n.createElement)(g.Button,{icon:j(l.type),title:l.type},(0,p.__)("Block Binding"))),(0,n.createElement)(g.__experimentalGrid,{columns:3},(0,n.createElement)(g.TextControl,{label:(0,p.__)("Name"),value:l.label,disabled:!0}),(0,n.createElement)(g.TextControl,{label:(0,p.__)("Key"),value:l.slug,disabled:!0}),(0,n.createElement)(g.TextControl,{label:(0,p.__)("Description (optional)"),value:l.description,onChange:e=>a({...l,description:e})})),(0,n.createElement)(N,{slug:l.slug,type:l.type}))))},A=()=>{const[e,t]=(0,_.useEntityProp)("postType",d,"meta"),l=e?.fields?JSON.parse(e.fields):[],a=e=>{t({fields:JSON.stringify(e)})},r=e=>{const t=l.filter((t=>t.uuid!==e.uuid));a(t)},o=e=>{const t=l.map((t=>t.uuid===e.uuid?e:t));a(t)};return(0,n.createElement)(n.Fragment,null,(0,n.createElement)("p",null,(0,p.__)("Custom fields show up in the post sidebar.")),(0,n.createElement)(g.__experimentalVStack,{spacing:2},l.map((e=>(0,n.createElement)(O,{key:e.uuid,field:e,onDelete:r,onChange:o,total:l.length,index:l.findIndex((t=>t.uuid===e.uuid)),onMoveUp:e=>{const t=l.findIndex((t=>t.uuid===e.uuid)),n=[...l];n.splice(t,1),n.splice(t-1,0,e),a(n)},onMoveDown:e=>{const t=l.findIndex((t=>t.uuid===e.uuid)),n=[...l];n.splice(t,1),n.splice(t+1,0,e),a(n)}}))),(0,n.createElement)(g.Button,{variant:"secondary",style:{marginTop:"1rem"},onClick:()=>a([...l,{uuid:crypto.randomUUID(),label:"",slug:"",description:"",type:"text",visible:!0}])},(0,p.__)("Add Field"))))},H=()=>{const[e]=(0,_.useEntityProp)("postType",d,"meta"),t=e?.blocks?JSON.parse(e.blocks):[];return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(g.__experimentalVStack,{spacing:2},t.map((e=>(0,n.createElement)(G,{key:e.uuid,block:e})))))},L=e=>{switch(e){case"core/paragraph":return S;case"core/image":return P;case"core/heading":return C;case"core/group":return F;case"core/button":return I;default:return T}};(0,a.addFilter)("editor.BlockEdit","content-model/attribute-binder",w),(0,b.registerPlugin)("create-content-model-cpt-settings-panel",{render:function(){const[e,t]=(0,_.useEntityProp)("postType",d,"meta"),[l,a]=(0,_.useEntityProp)("postType",d,"title"),o=(0,r.useRef)(l);(0,r.useLayoutEffect)((()=>{l!==o.current&&(o.current=l,t({...e,plural_label:`${l}s`}))}),[l,e,t]);const i=e.icon.replace("dashicons-","");return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(x.PluginDocumentSettingPanel,{name:"create-content-model-post-settings",title:(0,p.__)("Post Type"),className:"create-content-model-post-settings"},(0,n.createElement)(g.TextControl,{label:(0,p.__)("Singular Label"),value:l,onChange:a,help:(0,p.__)("This is synced with the post title")}),(0,n.createElement)(g.TextControl,{label:(0,p.__)("Plural Label"),value:e.plural_label,onChange:l=>t({...e,plural_label:l}),help:(0,p.__)("This is the label that will be used for the plural form of the post type")}),(0,n.createElement)("div",{style:{position:"relative"}},(0,n.createElement)(g.TextControl,{label:(0,p.__)("Icon name"),value:e.icon,onChange:l=>t({...e,icon:l}),help:(0,r.createInterpolateElement)((0,p.__)("The icon for the post type. <a>See reference</a>"),{a:(0,n.createElement)("a",{target:"_blank",href:"https://developer.wordpress.org/resource/dashicons/",rel:"noreferrer"})})}),i&&(0,n.createElement)("div",{style:{position:"absolute",top:"24px",right:"6px",height:"32px",display:"flex",alignItems:"center"}}," ",(0,n.createElement)(g.Dashicon,{icon:i})," "))))}}),(0,b.registerPlugin)("create-content-model-fields-ui",{render:function(){const[e,t]=(0,r.useState)(!1),[l]=(0,_.useEntityProp)("postType",d,"meta"),a=l?.fields?JSON.parse(l.fields):[],o=l?.blocks?JSON.parse(l.blocks):[],i=o.length>0||a.length>0;return(0,n.createElement)(n.Fragment,null,(0,n.createElement)(x.PluginDocumentSettingPanel,{name:"create-content-model-field-settings",title:(0,p.__)("Post Meta"),className:"create-content-model-field-settings"},i&&(0,n.createElement)(g.__experimentalItemGroup,{isBordered:!0,isSeparated:!0},o.map((e=>(0,n.createElement)(g.__experimentalItem,{key:e.uuid},(0,n.createElement)(g.Flex,null,(0,n.createElement)(g.FlexItem,null,(0,n.createElement)(g.Icon,{icon:L(e.type)})),(0,n.createElement)(g.FlexBlock,null,e.label),(0,n.createElement)(g.FlexItem,null,(0,n.createElement)("code",null,e.slug)))))),a.map((e=>(0,n.createElement)(g.__experimentalItem,{key:e.uuid},(0,n.createElement)(g.Flex,null,(0,n.createElement)(g.FlexItem,null,(0,n.createElement)(g.Icon,{icon:B})),(0,n.createElement)(g.FlexBlock,null,e.label),(0,n.createElement)(g.FlexItem,null,(0,n.createElement)("code",null,e.slug))))))),(0,n.createElement)(g.PanelRow,null,(0,n.createElement)(g.Button,{variant:"secondary",onClick:()=>t(!0)},(0,p.__)("Manage Post Meta"))),e&&(0,n.createElement)(g.Modal,{title:(0,p.__)("Post Meta"),size:"large",onRequestClose:()=>t(!1)},(0,n.createElement)(g.TabPanel,{tabs:[{name:"fields",title:(0,p.__)("Custom Fields"),content:(0,n.createElement)(A,null)},{name:"blocks",title:(0,p.__)("Block Bindings"),content:(0,n.createElement)(H,null)}]},(e=>(0,n.createElement)(n.Fragment,null,e.content))))))}}),(0,b.registerPlugin)("content-model-name-validation",{render:()=>{(()=>{const{editPost:e,lockPostSaving:t,unlockPostSaving:l}=(0,i.useDispatch)(x.store),{createNotice:n,removeNotice:a}=(0,i.useDispatch)(y.store),{title:o,isPublishSidebarOpened:c,isPublishingPost:s}=(0,i.useSelect)((e=>({title:e(x.store).getEditedPostAttribute("title"),isPublishSidebarOpened:e(x.store).isPublishSidebarOpened(),isPublishingPost:e(x.store).isPublishingPost()})));(0,r.useEffect)((()=>{var r;const i=null!==(r=o?.trim())&&void 0!==r?r:"";0===i.length?t("title-empty-lock"):(l("title-empty-lock"),a("title-empty-notice"),e({title:i.substring(0,20)}),i.length>20&&n("warning",(0,p.__)("Model name is limited to 20 characters."),{id:"title-length-notice",type:"snackbar",isDismissible:!0})),(c||s)&&0===i.length&&n("warning",(0,p.__)("Please enter a model name in order to publish."),{id:"title-empty-notice",isDismissible:!0})}),[o,c,s,t,l,e,n,a])})()}}),(0,b.registerPlugin)("content-model-default-value-placeholder-changer",{render:()=>{(()=>{const e=(0,i.useSelect)((e=>{const t=e(c.store).getBlocks(),l={},n=e=>{const t=e.attributes?.metadata?.name;t&&(l[e.clientId]=e.attributes.metadata.name),e.innerBlocks&&e.innerBlocks.length>0&&e.innerBlocks.forEach(n)};return t.forEach(n),l}),[]),{updateBlockAttributes:t}=(0,i.useDispatch)(c.store);(0,r.useEffect)((()=>{Object.entries(e).forEach((([e,l])=>{t(e,{placeholder:(0,p.sprintf)(
// translators: %s is the block binding's name.
// translators: %s is the block binding's name.
(0,p.__)("Add placeholder value for %s"),l)})}))}),[e,t])})()}})})();